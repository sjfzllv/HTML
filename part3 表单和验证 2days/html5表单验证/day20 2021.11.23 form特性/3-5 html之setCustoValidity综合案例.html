<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0 user-scalable=0, minimum-scale=1.0, maxinmum-scale=1.0">
    <title>form test</title>
    <style>
        input[type="text"] {border: 1px solid #ccc; width: 150px; height:30px; border-radius: 5px;}
        input[type="submit"] {background-color: #eee; border: 1px solid #ddd; width: 60px; height: 33px;border-radius: 5px;}

    </style>
</head>

<body>
    <form action="" name="test" method="post">
        <input type="text" required pattern="\d{4}$" placeholder="请输入代码" oninput="checkit(this)">
        <input type="submit" value="验证">
    </form>


    <script type="text/javascript">
        function checkit(obj) {
            console.log(obj.validity);
            var it = obj.validity;
            if (true === it.valueMissing) {
                obj.setCustomValidity("不能为空!");
            } else {
                if(true === it.patternMismatch) {
                    obj.setCustomValidity("必须是4个数字！")
                } else {
                    obj.setCustomValidity("")
                }

            }
        }

    </script>
</body>
</html>